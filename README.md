# Проект «Прогнозирование количества товаров в зависимости от погодных условий»

**Авторы:**  
- Вячин Александр (Тимлид)  
- Булхуков Абя
- Гутуев Никита 
- Плотников Иван

## Цель проекта

Необходимо разработать модель, которая позволит оценить влияние погодных условий на продажи товаров в определенных локациях.

### Основные аспекты проекта

- **Связь станций с городами:** Найти пары "станция-город" исходя из анализа данных.
- **EDA:** Провести развернутый анализ данных относительно weather.csv.
- **Выбор и обучение модели:** Подобрать модель, которая будет являться одновременно интепретируемой и хорошо описывающей нелинейные связи в признаках и обучить.
- **Система коэффициентов:** Получить из обученной модели систему коэффициентов, описыващих зависимость количества товара от погодных условий.
- **Реализация веб-сервера:** Реализовать удобный интерфейс на основе веб-сервера для наглядности прогнозирования.

## Структура репозитория

- [**data/**](./data/):
  - Архив всех данных, использованных в проекте.

- [**model/**](./analysis/):
  - Содержит скрипт с EDA "weather_full_ead_script.pt".
  - Ноутбук "data_cleaning.ipynb" с сопоставлением пар город-станция и предобработкой данных.
  - Обучение модели и получение коэффициентов в "getting_coefs.ipynb".
  - README-файл с описанием шагов.

- [**web/**](./web/):
  - Jupyter-ноутбук с анализом проблемы лесных пожаров.
  - Статистика по экономическим потерям, ущербу экосистем, сезонности и распределению пожаров по типам и причинам.
  - Визуализация данных, подтверждающая значимость раннего обнаружения и контроля.

## Технологии и инструменты

- **Языки и фреймворки:**  
  - Python 3.10+  
  - Flask (серверная часть)
  - folium (карта мира с поддержкой координат)
  - pandas/numpy (извлечение, анализ и предобработка данных)
  - sklearn/pygam (обучение модели)
  
- **Модель:**  
  - Poisson Generalized Additive Models.
  - Достигнута MAE со всеми типами товаров города Dallas в ~23.13 на тестовой выборке.

- **Аналитика и визуализация:**  
  - Jupyter Notebook для прототипирования, анализа данных и экспериментов.
  - Matplotlib, Seaborn и другие библиотеки для графического представления информации.

- **Управление проектом:**  
  - GitHub для контроля версий.

## Промежуточные этапы

- **Проведен анализ данных:**  
  - Произведена первичная предобработка данных.
  - Сохранены сводные статистики.
  - Визуализирована зависимость средней температуры по времени для каждой станции и осадков по времени.
  - Построена матрица корреляции.
    
- **Найдены пары "станция-город":**
  - Были сопоставлены даты по дням-месяцам.
  - Найдена сумма температур и осадков.
  - Сопоставлены города и станции по возрастанию сумм и сохранены в "city_station.csv".
  - Произведена полная предобработка данных и сохранена в "weather_clean.csv".

- **Обучение модели:**  
  - Произведен выбор модели.
  - Выбрана отдельная группа данных для обучения в прототипе.
  - Получены коэффициенты.

- **Веб-сервер:**  
  - Написан прототип фронта веб-сервера.
  - Внедрена карты мира с возможностью масштабирования и прорисовки heatmap.
  - Реализована загрузка данных через кнопку.

## Дальнейшее развитие

- Получение коэффициентов на полном датасете: Извлечение коэффициентов для каждой пары "номер товара - город".
- Улучшение точности: Использование GridSearch для перебора гиперпараметров и тензорных представлений более точного нелинейного описания.
- Развертка данных на веб-сервере: Написать извлечение и предобработку данных, с последующим расчетом intensity для heatmap.
- Улучшение фронт-составляющей веб-сервера: Добавление ползунка по датам и визуализация heatmap с данных на карте.

## Лицензия

Проект распространяется по лицензии MIT. Подробности в файле `LICENSE`.

